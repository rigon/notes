<!DOCTYPE html>
<html>
	<head>
		<title>Editing page - Spmdwe Editor</title>
		
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta charset="UTF-8">
		
		<link rel="stylesheet" type="text/css" href="./static/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="./static/css/font-awesome.min.css" />
		
		<script src="./static/js/jquery-1.11.1.min.js"></script>
		<script src="./static/js/bootstrap.min.js"></script>
		<script src="./static/js/dropzone.js"></script>

		<script src="./static/js/ace-editor/ace.js" type="text/javascript" charset="utf-8"></script>

		<style type="text/css">
			.preview-wrapper, #editor {
				position: absolute;
				top: 0px;
				bottom: 0px;
				width: 50%;
			}
			.preview-wrapper {
				left: 0px;
			}
			#preview {
				position: absolute; 
				width: 100%;
				height: 100%;
				border: none;
			}
			#editor {
				right: 0px;
				border-left: 1px solid gray;
				background-color: white;
			}
			#editor .nav-tabs {
				padding: 9px 7px 0px 7px;
			}
			#editor .toolbar .btn {
				border: none;
				border-radius: 0px;
			}
			#editor textarea {
				resize: vertical;
			}
			#editor .editor, #editor .editor-ace {
				border-top: 1px solid lightgray;
				overflow: auto;
				position: absolute;
				top: 82px;
				right: 0px;
				bottom: 0px;
				width: 100%;
			}
			#editor .editor {
				padding: 15px;
			}
			#editor .editor-ace {
				font-size: 14px;
			}






			@media (min-width: 992px) {
				.editor-container {
					position: fixed;
				}
			}
			@media (max-width: 992px) {
				.editor {
					padding-left: 0px;
				}
			}

			/* The total progress gets shown by event listeners */
			#total-progress {
				opacity: 0;
				transition: opacity 0.3s linear;
			}

			/* Hide the progress bar when finished */
			#previews .file-row.dz-success .progress {
				opacity: 0;
				transition: opacity 0.3s linear;
			}

			/* Hide the delete button initially */
			#previews .file-row .delete {
				display: none;
			}

			/* Hide the start and cancel buttons and show the delete button */
			#previews .file-row.dz-success .start,
			#previews .file-row.dz-success .cancel {
				display: none;
			}
			#previews .file-row.dz-success .delete {
				display: block;
			}
			
		</style>
	</head>
	<body>
		<noscript>
			JavaScript not detected; JavaScript is required for editing parts of the application.
		</noscript>
		
		<!-- Preview -->
		<div class="preview-wrapper">
			<iframe id="preview" src="http://www.rigon.tk"></iframe>
		</div>

		<div id="editor">

			<!-- Nav tabs -->
			<ul class="nav nav-tabs navbar-default" id="#editor-tabs" role="tablist">
				<li role="presentation" class="active"><a href="#editor-page" aria-controls="editor-page" role="tab" data-toggle="tab">Page</a></li>
				<li role="presentation"><a href="#editor-text" aria-controls="editor-text" role="tab" data-toggle="tab">Text</a></li>
				<li role="presentation"><a href="#editor-files" aria-controls="editor-files" role="tab" data-toggle="tab">Files</a></li>
				<li role="presentation"><a href="#editor-styles" aria-controls="editor-styles" role="tab" data-toggle="tab">Styles</a></li>
				<li role="presentation"><a href="#editor-script" aria-controls="editor-script" role="tab" data-toggle="tab">Script</a></li>
				<li role="presentation"><a href="#editor-template" aria-controls="editor-template" role="tab" data-toggle="tab">Template</a></li>
				<li class="pull-right">
					<button class="btn btn-default">Close</button>
					<button class="btn btn-info">Publish</button>
					<button class="btn btn-primary">Save</button>
				</li>
			</ul>

			<div class="btn-group toolbar pull-right" role="group">
				<button type="button" class="btn btn-default btn-help" title="Help" data-toggle="modal" data-target="#editor .tab-content .active .help"><span class="fa fa-info-circle"></span></button>
				<button type="button" class="btn btn-default btn-detachpreview" title="Detach/Atach preview in a new window"><span class="fa fa-window-restore"></span></button>
				<button type="button" class="btn btn-default btn-maximize" title="Maximize editor and hide preview"><span class="fa fa-window-maximize"></span></button>
				<button type="button" class="btn btn-default btn-fullscreen"><span class="fa fa-expand"></span></button>
			</div>

			<div class="tab-content">
				<!-- Panel Editor Page -->
				<div role="tabpanel" class="tab-pane active" id="editor-page">
					<!-- Panel Editor Page Toolbar -->
					<div class="btn-group toolbar" role="group">
						<div class="btn-group" role="group" title="History">
							<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<span class="fa fa-history"></span> History <span class="caret">
							</button>
							<ul class="dropdown-menu">
								<li><a href="#">Latest version</a></li>
								<li class="divider"></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
								<li><a href="#">2016-12-12 08:43:24</a></li>
							</ul>
						</div>
						
						<div class="btn-group" role="group">
							<div class="btn-group" role="group" title="Download">
								<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									<span class="fa fa-cloud-download"></span> Download <span class="caret">
								</button>
								<ul class="dropdown-menu">
									<li><a href="#">As HTML</a></li>
									<li><a href="#">As Markdown</a></li>
									<li><a href="#">Entire page as ZIP</a></li>
								</ul>
							</div>
						</div>

						<div class="btn-group" role="group">
							<div class="btn-group" role="group" title="Share">
								<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									<span class="fa fa-share-alt"></span> Share <span class="caret">
								</button>
								<ul class="dropdown-menu">
									<li><a href="#"><span class="fa fa-chain-broken"></span> Create private link</a></li>
									<li class="divider"></li>
									<li><a href="#"><span class="fa fa-dropbox"></span> Dropbox</a></li>
									<li><a href="#"><span class="fa fa-google"></span> Google Drive</a></li>
									<li><a href="#"><span class="fa fa-windows"></span> Microsoft OneDrive</a></li>
								</ul>
							</div>
						</div>
					</div>
					
					<!-- /Panel Editor Page Toolbar -->
					
					<div class="editor">
						<form class="form-horizontal">
							<div class="form-group">
								<label for="properties-title" class="col-sm-2 control-label">Title</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="properties-title" placeholder="Page title">
								</div>
							</div>
							<div class="form-group">
								<label for="properties-keywords" class="col-sm-2 control-label">Keywords</label>
								<div class="col-sm-10">
									<input type="text" class="form-control" id="properties-keywords" placeholder="Keywords">
								</div>
							</div>
							<div class="form-group">
								<label for="properties-description" class="col-sm-2 control-label">Description</label>
								<div class="col-sm-10">
									<textarea class="form-control" id="properties-description" rows="4" placeholder="Description"></textarea>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-offset-2 col-sm-10">
									Changes are immediatily published when you save.
								</div>
							</div>
							<hr>
							<div class="form-group">
								<label class="col-sm-2 control-label">Download</label>
								<div class="col-sm-10">
									<button class="btn btn-default">HTML</button>
									<button class="btn btn-default">Markdown</button>
									<button class="btn btn-default">Whole page as ZIP</button>
								</div>
							</div>
							
							<div class="form-group">
								<label class="col-sm-2 control-label">Read only</label>
								<div class="col-sm-10">
									<button class="btn btn-warning" id="properties-readonly">Make this page read-only</button>
								</div>
							</div>
						</form>
					</div>

					<!-- Panel Editor Page Help -->
					<div class="modal fade help" id="myModal" tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Help: Page properties</h4>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /Panel Editor Page Help -->

				</div>
				

				<!-- Panel Editor Text -->
				<div role="tabpanel" class="tab-pane" id="editor-text">
					<!-- Panel Editor Text Toolbar -->
					<div class="btn-group toolbar" role="group">
						<button type="button" class="btn btn-default" title="Bold"><span class="fa fa-bold"></span></button>
						<button type="button" class="btn btn-default" title="Italic"><span class="fa fa-italic"></span></button>
					</div>
					<div class="btn-group toolbar" role="group">
						<button type="button" class="btn btn-default" title="Quote text"><span class="fa fa-quote-left"></span></button>
						<button type="button" class="btn btn-default" title="Block of code"><span class="fa fa-code"></span></button>
						<button type="button" class="btn btn-default" title="Add image"><span class="fa fa-image"></span></button>
						<button type="button" class="btn btn-default" title="Hyperlink"><span class="fa fa-link"></span></button>
						<div class="btn-group" role="group" title="Link for pages">
							<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<span class="fa fa-file-text"></span> <span class="caret">
							</button>
							<ul class="dropdown-menu">
								<li><a href="#">New Page</a></li>
								<li class="divider"></li>
								<li><a href="#">Page 1</a></li>
								<li><a href="#">Page 2</a></li>
								<li><a href="#">Page 3</a></li>
								<li><a href="#">Page 4</a></li>
								<li><a href="#">Page 5</a></li>
								<li><a href="#">Page 6</a></li>
							</ul>
						</div>
					</div>
					<div class="btn-group toolbar" role="group">
						<button type="button" class="btn btn-default" title="Ordered list"><span class="fa fa-list-ol"></span></button>
						<button type="button" class="btn btn-default" title="Unordered list"><span class="fa fa-list-ul"></span></button>
						<button type="button" class="btn btn-default" title="Header"><span class="fa fa-header"></span></button>
						<button type="button" class="btn btn-default" title="Table"><span class="fa fa-table"></span></button>
					</div>
					<div class="btn-group toolbar" role="group">
						<button type="button" class="btn btn-default" title="Undo"><span class="fa fa-undo"></span></button>
						<button type="button" class="btn btn-default" title="Redo"><span class="fa fa-repeat"></span></button>
					</div>
					<!-- /Panel Editor Text Toolbar -->

					<div id="markdown-editor" class="editor-ace"></div>
					<script type="text/javascript">
						var markdownEditor = ace.edit("markdown-editor");
						markdownEditor.setTheme("ace/theme/dreamweaver");
						markdownEditor.getSession().setMode("ace/mode/markdown");
						markdownEditor.setShowPrintMargin(false);
					</script>

					<!-- Panel Editor Text Help -->
					<div class="modal fade help" id="myModal" tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Help: Text editor</h4>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /Panel Editor Page Help -->

				</div>


				<!-- Panel Files -->
				<div role="tabpanel" class="tab-pane" id="editor-files">

					<!-- Panel Files Toolbar -->
					<div class="btn-group toolbar" role="group">
						<!-- The fileinput-button span is used to style the file input field as button -->
						<button class="btn btn-default" id="editor-files-add"><span class="fa fa-plus"></span> Add files...</button>
						<button class="btn btn-default" id="editor-files-start"><span class="fa fa-upload"></span> Upload</button>
						<button class="btn btn-default" id="editor-files-cancel"><span class="fa fa-ban"></span> Cancel all</button>
					</div>
					<!-- /Panel Files Toolbar -->

					<!-- The global file processing state -->
					<div class="fileupload-process">
						<div id="total-progress" class="progress progress-striped active" style="height: 34px; margin-bottom: 0px;" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
							<div class="progress-bar progress-bar-success" style="width: 0%;" data-dz-uploadprogress></div>
						</div>
					</div>

					<div class="editor">

						<!-- When there is no files to upload -->
						<p class="fileupload-noupload">There are no files to upload</p>

						<!-- This is used as the file preview template -->
						<div class="table table-striped files" id="fileupload-template">
							<div class="file-row">
								<div class="media">
									<div class="media-body" style="width: 100%">

										<div class="btn-group pull-right">
											<button data-dz-size class="btn btn-default btn-sm" disabled></button>
											<button class="btn btn-primary btn-sm start" title="Start"><span class="fa fa-upload"></span></button>
											<button data-dz-remove class="btn btn-warning btn-sm cancel" title="Cancel"><span class="fa fa-ban"></span></button>
											<button data-dz-remove class="btn btn-danger btn-sm delete" title="Delete"><span class="fa fa-trash"></span></button>
										</div>
										<p class="media-heading name" data-dz-name></p>
										
										
										<div class="progress progress-striped active" style="height: 30px; clear: both" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
											<div class="progress-bar progress-bar-success" style="width: 0%;" data-dz-uploadprogress></div>
										</div>
											
										<strong class="error text-danger" data-dz-errormessage></strong>
									</div>
									<div class="media-right">
										<img class="media-object" data-dz-thumbnail />
									</div>
								</div>
							</div>
						</div>
						
						<!-- List of uploaded files -->
						<hr><p>There are no uploaded files</p>
					</div>
					
					<!-- Panel Files Help -->
					<div class="modal fade help" id="myModal" tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Help: Files manager</h4>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /Panel Files Help -->
			
				</div>


				<!-- Panel Editor Styles -->
				<div role="tabpanel" class="tab-pane" id="editor-styles">

					<div id="css-editor" class="editor-ace"></div>
					<script type="text/javascript">
						var cssEditor = ace.edit("css-editor");
						cssEditor.setTheme("ace/theme/dreamweaver");
						cssEditor.getSession().setMode("ace/mode/css");
						cssEditor.setShowPrintMargin(false);
					</script>

										
					<!-- Panel Editor Styles Help -->
					<div class="modal fade help" id="myModal" tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Help: Styles editor</h4>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /Panel Editor Styles Help -->

				</div>


				<!-- Panel Editor Script -->
				<div role="tabpanel" class="tab-pane" id="editor-script">

					<div id="js-editor" class="editor-ace"></div>
					<script type="text/javascript">
						var jsEditor = ace.edit("js-editor");
						jsEditor.setTheme("ace/theme/dreamweaver");
						jsEditor.getSession().setMode("ace/mode/javascript");
						jsEditor.setShowPrintMargin(false);
					</script>

					<!-- Panel Editor Script Help -->
					<div class="modal fade help" id="myModal" tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Help: Script editor</h4>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /Panel Editor Script Help -->
					
				</div>


				<!-- Panel Editor Template -->
				<div role="tabpanel" class="tab-pane" id="editor-template">

					<div id="handlebars-editor" class="editor-ace"></div>
					<script type="text/javascript">
						var jsEditor = ace.edit("handlebars-editor");
						jsEditor.setTheme("ace/theme/dreamweaver");
						jsEditor.getSession().setMode("ace/mode/handlebars");
						jsEditor.setShowPrintMargin(false);
					</script>

					<!-- Panel Editor Template Help -->
					<div class="modal fade help" id="myModal" tabindex="-1" role="dialog">
						<div class="modal-dialog" role="document">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									<h4 class="modal-title" id="myModalLabel">Help: Template editor</h4>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
								</div>
							</div>
						</div>
					</div>
					<!-- /Panel Editor Template Help -->

				</div>

			</div>
		</div>



		<script type="text/javascript">
			$(".btn-maximize").click(function() {
				if(($("#editor").width() / $('body').width()) < 0.75) {
					$("#editor").css("width", "100%");
					$(".btn-maximize span").attr("class", "fa fa-columns");
				}
				else {
					$("#editor").css("width", "50%");
					$(".btn-maximize span").attr("class", "fa fa-window-maximize");
				}
			});

			$(".btn-fullscreen").click(function() {
				if((document.fullScreenElement && document.fullScreenElement !== null) || (!document.mozFullScreen && !document.webkitIsFullScreen)) {
					if(document.documentElement.requestFullScreen) document.documentElement.requestFullScreen();
					else if(document.documentElement.mozRequestFullScreen) document.documentElement.mozRequestFullScreen();
					else if(document.documentElement.webkitRequestFullScreen) document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);
					$(".btn-fullscreen span").attr("class", "fa fa-compress");
				}
				else {
					if(document.cancelFullScreen) document.cancelFullScreen();
					else if(document.mozCancelFullScreen) document.mozCancelFullScreen();
					else if(document.webkitCancelFullScreen) document.webkitCancelFullScreen();
					$(".btn-fullscreen span").attr("class", "fa fa-expand");
				}
			});
		</script>

		
		<script type="text/javascript">
			// Disable auto discover for all elements:
			Dropzone.autoDiscover = false;
			// Get the template HTML and remove it from the document
			var previewTemplate = $("#fileupload-template").html();
			$("#fileupload-template").empty();

			var dropzone = new Dropzone(document.documentElement, {		// Make the whole document a dropzone
				url: "http://www.example.com/urltosend",	// Set the url
				maxFilesize: 52,							// TODO
				thumbnailWidth: 80,
				thumbnailHeight: 80,
				parallelUploads: 3,
				previewTemplate: previewTemplate,			// HTML template for new uploads
				autoQueue: false,							// Make sure the files aren't queued until manually added
				previewsContainer: "#fileupload-template",	// Define the container to display the previews
				clickable: "#editor-files-add",				// Define the element that should be used as click trigger to select files.
			});

			dropzone.on("addedfile", function(file) {
				// Hookup the start button
				file.previewElement.querySelector(".start").onclick = function() { dropzone.enqueueFile(file); };
				$('#editor .nav-tabs a[href="#editor-files"]').tab('show');
				$("#editor-files .fileupload-noupload").hide();
			});
			
			dropzone.on("removedfile", function(file) {
				if(this.getQueuedFiles().length + this.getUploadingFiles().length + this.getRejectedFiles().length < 1)
					$("#editor-files .fileupload-noupload").show();
			});

			// Update the total progress bar
			dropzone.on("totaluploadprogress", function(progress) {
				document.querySelector("#total-progress .progress-bar").style.width = progress + "%";
			});

			dropzone.on("sending", function(file, xhr, formData) {
				formData.append("mode", "upload");
				// Show the total progress bar when upload starts
				document.querySelector("#total-progress").style.opacity = "1";
				// And disable the start button
				file.previewElement.querySelector(".start").setAttribute("disabled", "disabled");
			});

			// Hide the total progress bar when nothing's uploading anymore
			dropzone.on("queuecomplete", function(progress) {
				document.querySelector("#total-progress").style.opacity = "0";
			});

			// Setup the buttons for all transfers
			// The "add files" button doesn't need to be setup because the config
			// `clickable` has already been specified.
			$("#editor-files-start").click(function() {
				dropzone.enqueueFiles(dropzone.getFilesWithStatus(Dropzone.ADDED));
			});
			$("#editor-files-cancel").click(function() {
				dropzone.removeAllFiles(true);
			});
			$("#editor-files").click(function (e) {
				e.stopPropagation();
			});
		</script>
	</body>
</html>
